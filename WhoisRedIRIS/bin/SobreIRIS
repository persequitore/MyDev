#!/usr/bin/perl
#

use Proc::Daemon;
use constant PROCDAEMON_MIN_VER => 0.10;
require Proc::Daemon;
unless ( $Proc::Daemon::VERSION >= PROCDAEMON_MIN_VER ) {
	die "Proc::Daemon version ", PROCDAEMON_MIN_VER, " required",
	"--this is only version $Proc::Daemon::VERSION\n";
};

my $workdir = '/tmp/';
my $outputfile = '/tmp/sobreirisd.file';
my $errorfile = $outputfile;
my $pidfile = '/var/run/sobreiris.pid';

my $daemon = Proc::Daemon->new(
        work_dir     => $workdir,
        child_STDOUT => $outputfile,
        child_STDERR => $errorfile,
        pid_file     => $pidfile,
        exec_command => '/usr/bin/perl /usr/local/bin/SobreIRIS-v6',
    );
# Initilization of the program
my $pid = $daemon->Init();

my $status = $daemon->Status($pid);
my $statusstr = '';
if ($status > 0) {
	$statusstr = "OK";
} else {
	$statusstr = "FALLO";
}

exit (0);

